<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø±ÙƒØ² Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© | M PRIME</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&family=Aref+Ruqaa:wght@700&display=swap" rel="stylesheet">
    <style>
        :root { --primary-red: #FF0000; --bg-gray: #f8fafc; --text-dark: #1e293b; }
        body { margin: 0; padding: 0; background-color: var(--bg-gray); font-family: 'Cairo', sans-serif; overflow-x: hidden; }

        /* Ø´Ø§Ø´Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ */
        #welcome-screen { 
            position: fixed; inset: 0; background: #fff; z-index: 1000;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            transition: opacity 0.8s ease;
        }
        .logo-m { font-family: 'Aref Ruqaa', serif; font-size: 120px; color: var(--primary-red); animation: pulse 2s infinite; }

        /* Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø´Ø§Ù…Ù„Ø© */
        #admin-center { display: none; opacity: 0; transition: opacity 1s ease; padding-bottom: 50px; }

        .header { background: #fff; padding: 15px 5%; border-bottom: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 100; }
        .nav-logo { font-family: 'Aref Ruqaa', serif; font-size: 35px; color: var(--primary-red); text-decoration: none; }

        .main-container { max-width: 1000px; margin: 30px auto; padding: 0 20px; }
        .grid-settings { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }

        .card { background: #fff; border-radius: 18px; padding: 25px; border: 1px solid #e2e8f0; transition: 0.3s; }
        .card:hover { transform: translateY(-5px); border-color: var(--primary-red); box-shadow: 0 10px 20px rgba(0,0,0,0.05); }
        
        .icon-box { font-size: 32px; margin-bottom: 15px; }
        .card-title { font-size: 18px; font-weight: 700; color: var(--text-dark); margin-bottom: 10px; }
        .card-desc { font-size: 14px; color: #64748b; margin-bottom: 20px; line-height: 1.5; }

        .btn-action { 
            width: 100%; padding: 12px; border: 1px solid var(--primary-red); color: var(--primary-red);
            background: transparent; border-radius: 10px; font-weight: 700; cursor: pointer; transition: 0.3s;
            text-align: center; font-family: 'Cairo'; text-decoration: none; display: block;
        }
        .btn-action:hover { background: var(--primary-red); color: #fff; }
        .btn-primary { background: var(--primary-red); color: #fff; border: none; }

        .logout-btn { color: #64748b; text-decoration: none; font-size: 14px; cursor: pointer; border: none; background: none; font-family: 'Cairo'; }

        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
    </style>
</head>
<body>

    <div id="welcome-screen">
        <div class="logo-m">M</div>
        <h2 style="margin-top:20px;">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙŠØ§ Ø´Ø±ÙŠÙƒ Ø§Ù„Ù†Ø¬Ø§Ø­</h2>
        <p style="color: #64748b;">Ø¬Ø§Ø±ÙŠ ÙØªØ­ Ù…Ø±ÙƒØ² Ø¥Ø¯Ø§Ø±Ø© Ù…ØªØ¬Ø±Ùƒ...</p>
    </div>

    <div id="admin-center">
        <header class="header">
            <a href="#" class="nav-logo">M</a>
            <div style="font-weight: 700;">Ù…Ø±ÙƒØ² Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</div>
            <button onclick="logout()" class="logout-btn">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
        </header>

        <div class="main-container">
            <div style="margin-bottom: 30px;">
                <h1 style="font-size: 24px;">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø´Ø§Ù…Ù„Ø©</h1>
                <p style="color: #64748b;">Ø£Ù‡Ù„Ø§Ù‹ Ø¨ÙƒØŒ ÙƒÙ„ Ù…Ø§ ØªØ­ØªØ§Ø¬Ù‡ Ù„Ø¥Ø¯Ø§Ø±Ø© Ù…ØªØ¬Ø±Ùƒ ÙÙŠ Ù…ÙƒØ§Ù† ÙˆØ§Ø­Ø¯.</p>
            </div>

            <div class="grid-settings">
                <div class="card">
                    <div class="icon-box">ğŸ“¦</div>
                    <div class="card-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</div>
                    <div class="card-desc">Ø£Ø¶Ù Ù…Ù†ØªØ¬Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©ØŒ Ø­Ø¯Ø« Ø§Ù„Ø£Ø³Ø¹Ø§Ø±ØŒ ÙˆØ±Ø§Ù‚Ø¨ Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ.</div>
                    <button onclick="addNewProduct()" class="btn-action btn-primary">Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯</button>
                </div>

                <div class="card">
                    <div class="icon-box">ğŸ¨</div>
                    <div class="card-title">Ù‡ÙˆÙŠØ© Ø§Ù„Ù…ØªØ¬Ø±</div>
                    <div class="card-desc">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø´Ø¹Ø§Ø±ØŒ Ø§Ù„Ø£Ù„ÙˆØ§Ù†ØŒ ÙˆØ§Ø³Ù… Ø§Ù„Ù…ØªØ¬Ø± Ø§Ù„Ø°ÙŠ ÙŠØ¸Ù‡Ø± Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡.</div>
                    <button class="btn-action">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø¸Ù‡Ø±</button>
                </div>

                <div class="card">
                    <div class="icon-box">âš™ï¸</div>
                    <div class="card-title">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨</div>
                    <div class="card-desc">ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ©ØŒ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±ØŒ ÙˆØ·Ø±Ù‚ Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­.</div>
                    <button class="btn-action">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø³Ø§Ø¨</button>
                </div>

                <div class="card">
                    <div class="icon-box">ğŸšš</div>
                    <div class="card-title">Ø§Ù„Ø´Ø­Ù† ÙˆØ§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª</div>
                    <div class="card-desc">ØªÙØ¹ÙŠÙ„ Ø¨ÙˆØ§Ø¨Ø§Øª Ø§Ù„Ø¯ÙØ¹ ÙˆØ±Ø¨Ø· Ø´Ø±ÙƒØ§Øª Ø§Ù„Ø´Ø­Ù† Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ© Ø¨Ù…ØªØ¬Ø±Ùƒ.</div>
                    <button class="btn-action">Ø¶Ø¨Ø· Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>

    <script>
        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ
        const firebaseConfig = {
            apiKey: "AIzaSyCDeHg400vEdbUcGuo5RiagIAvh-EV0gLA",
            authDomain: "m-prime.firebaseapp.com",
            projectId: "m-prime"
        };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // Ø¨ÙŠØ§Ù†Ø§Øª Cloudinary Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ
        const CLOUD_NAME = "dzxkqvp36"; 
        const UPLOAD_PRESET = "mprime_upload"; 

        // 1. Ø§Ù„Ø­Ø§Ø±Ø³ Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠ: Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        auth.onAuthStateChanged((user) => {
            if (user) {
                startWelcomeTimer();
            } else {
                window.location.href = 'register.html';
            }
        });

        // 2. ÙˆØ¸ÙŠÙØ© Ø§Ù„ØªØ±Ø­ÙŠØ¨
        function startWelcomeTimer() {
            setTimeout(function() {
                document.getElementById('welcome-screen').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('welcome-screen').style.display = 'none';
                    document.getElementById('admin-center').style.display = 'block';
                    setTimeout(() => { document.getElementById('admin-center').style.opacity = '1'; }, 50);
                }, 800);
            }, 3000); // Ù‚Ù„Ù„Øª Ø§Ù„ÙˆÙ‚Øª Ù„Ù€ 3 Ø«ÙˆØ§Ù†Ù Ù„Ø±Ø§Ø­Ø© Ø§Ù„ØªØ§Ø¬Ø±
        }

        // 3. Ø§Ù„Ù…Ø­Ø±Ùƒ Ø§Ù„Ø³Ø­Ø±ÙŠ: Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ù…Ø¹ Ø±ÙØ¹ ØµÙˆØ±Ø©
        async function addNewProduct() {
            const fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.accept = 'image/*';

            fileInput.onchange = async (e) => {
                const file = e.target.files[0];
                if (!file) return;

                // ØªØºÙŠÙŠØ± Ù†Øµ Ø§Ù„Ø²Ø± Ù…Ø¤Ù‚ØªØ§Ù‹ Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø±ÙØ¹
                const btn = document.querySelector('.btn-primary');
                const originalText = btn.innerText;
                btn.innerText = "Ø¬Ø§Ø±ÙŠ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø©... â³";
                btn.disabled = true;

                const formData = new FormData();
                formData.append('file', file);
                formData.append('upload_preset', UPLOAD_PRESET);

                try {
                    // Ø§Ù„Ø±ÙØ¹ Ø¥Ù„Ù‰ Cloudinary
                    const res = await fetch(`https://api.cloudinary.com/v1_1/${CLOUD_NAME}/image/upload`, {
                        method: 'POST',
                        body: formData
                    });
                    const data = await res.json();
                    const imageUrl = data.secure_url;

                    // Ø·Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„ØªØ§Ø¬Ø±
                    const name = prompt("Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ø¬Ø¯ÙŠØ¯:");
                    const price = prompt("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø³Ø¹Ø± (Ø¨Ø§Ù„Ø±ÙŠØ§Ù„):");

                    if (name && price) {
                        const user = auth.currentUser;
                        await db.collection("products").add({
                            merchantId: user.uid,
                            productName: name,
                            productPrice: price,
                            productImage: imageUrl,
                            createdAt: firebase.firestore.FieldValue.serverTimestamp()
                        });
                        alert("Ù…Ù…ØªØ§Ø²! ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ ÙˆØµÙˆØ±ØªÙ‡ Ø¨Ù†Ø¬Ø§Ø­ ğŸš€");
                    }
                } catch (err) {
                    alert("Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø­Ø¯Ø« Ø®Ø·Ø£: " + err.message);
                } finally {
                    btn.innerText = originalText;
                    btn.disabled = false;
                }
            };
            fileInput.click();
        }

        // 4. ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
        function logout() {
            auth.signOut().then(() => {
                window.location.href = 'register.html';
            });
        }
    </script>
</body>
</html>
